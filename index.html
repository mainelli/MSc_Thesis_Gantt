<!-- Code adapted from Google Charts: https://developers.google.com/chart/interactive/docs/gallery/ganttchart
"Licensed under the Creative Commons Attribution 4.0 License, and code samples are licensed under the Apache 2.0 License." -->

<html>
<head>

  <h1> X.U. Mainelli's MSc Geomatics Thesis: Gantt Chart Plan </h1>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['gantt']});
    google.charts.setOnLoadCallback(drawChart);

    var today = new Date();
    var yyyy = today.getFullYear();
    var mm = String(today.getMonth()).padStart(2, '0');
    var dd = String(today.getDate()).padStart(2, '0');
    var mm_forshow = String(today.getMonth() +1).padStart(2, '0');
    var enddate = new Date("2022/6/24");

    today = new Date(yyyy, mm, dd);
    showdate = yyyy + ' / ' + (mm_forshow) + ' / ' + dd;
    var countdown = Math.abs(enddate-today);
    document.write("Today's date: " + showdate +"<br>");

    document.write("Days left until final presentation: " + (countdown/86400000));


    function millisecondsToDays(milliseconds) {
      return milliseconds / 1000 / 60 / 60 / 24;
    }

    function percent (startdate, duration) {
      var now = today; //"now"
      var start = startdate;  // some date
      var diff = (now-start);  // difference in milliseconds
      days = millisecondsToDays(diff);
      progress = ((days/duration) * 100);
      progress_rounded = Math.round(progress);
      if (progress_rounded <0) {
        percent_finished = 0;
      }
      else if (progress_rounded >100) {
        percent_finished = 100;
      }
      else {
        percent_finished = progress_rounded;
      }
      return percent_finished
    }

    function drawChart() {

      var otherData = new google.visualization.DataTable();
      otherData.addColumn('string', 'Task ID');
      otherData.addColumn('string', 'Task Name');
      otherData.addColumn('string', 'Category');
      otherData.addColumn('date', 'Start Date');
      otherData.addColumn('date', 'End Date');
      otherData.addColumn('number', 'Duration');
      otherData.addColumn('number', 'Percent Complete');
      otherData.addColumn('string', 'Dependencies');

      otherData.addRows([
        ['litrev', 'Literature Review', 'research', new Date(2021, 8, 1), new Date(2022, 3, 1), , percent(new Date(2021, 8, 1), 210), null],
        ['p1', 'P1: Refining Topic + Supervisors', 'evaluation', new Date(2021, 8, 1), new Date(2021, 8, 20), , percent(new Date(2021, 8, 1), 19), null],
        ['p2', 'P2: Assessment Graduation Plan', 'evaluation', new Date(2022, 0, 21), new Date(2022, 0, 22), , percent(new Date(2022, 0, 21), 1), 'submitrp'],
        ['p3', 'P3: Midterm Progress Meeting', 'evaluation', new Date(2022, 2, 25), new Date(2022, 2, 26), , percent(new Date(2022, 2, 25), 1), 'beginreport, buildviz'],
        ['p4', 'P4: Assessment Green Light', 'evaluation', new Date(2022, 4, 20), new Date(2022, 4, 21), , percent(new Date(2022, 4, 20), 1), 'submitdraft'],
        ['p5', 'P5: Assessment Final Presentation', 'evaluation', new Date(2022, 5, 24), new Date(2022, 5, 25), , percent(new Date(2022, 5, 24), 1), 'submitfinal, makepres'],
        ['scope', 'Evaluating Existing Solutions', 'exploration', new Date(2021, 8, 21), new Date(2021, 9, 31), , percent(new Date(2021, 8, 21), 40), 'p1'],
        ['reqs', 'Defining list of requirements', 'research', new Date(2021, 10, 1), new Date(2021, 10, 5), , percent(new Date(2021, 10, 1), 4), 'scope'],
        ['buildviz', 'Building Solution(s)', 'development', new Date(2022, 1, 7), new Date(2022, 2, 25), , percent(new Date(2022, 1, 7), 48), 'reqs, p2'],
        ['evalviz', 'Evaluating Solution(s)', 'research', new Date(2022, 2, 28), new Date(2022, 3, 8), , percent(new Date(2022, 2, 28), 11), 'buildviz'],
        ['refineviz', 'Refining Solution(s)', 'development', new Date(2022, 3, 11), new Date(2022, 4, 6), , percent(new Date(2022, 3, 11), 25), 'evalviz'],
        ['rp', 'Writing Research Proposal', 'writing', new Date(2021, 10, 1), new Date(2021, 11, 23), , percent(new Date(2021, 10, 1), 52), 'scope'],
        ['submitrp', 'Submit Research Proposal', 'deadline', new Date(2022, 0, 14), new Date(2022, 0, 15), , percent(new Date(2022, 0, 14), 1), 'rp'],
        ['demoreport', 'Drafting Introduction, Objectives, etc.', 'writing', new Date(2022, 0, 24), new Date(2022, 0, 28), , percent(new Date(2022, 0, 24), 4), ''],
        ['beginreport', 'Beginning report & finalising structure', 'writing', new Date(2022, 2, 14), new Date(2022, 2, 24), , percent(new Date(2022, 2, 14), 10), ''],
        ['draftreport', 'Writing Report', 'writing', new Date(2022, 3, 25), new Date(2022, 4, 12), , percent(new Date(2022, 3, 26), 17), 'p3'],
        ['submitdraft', 'Submit Draft Thesis', 'deadline', new Date(2022, 4, 13), new Date(2022, 4, 14), , percent(new Date(2022, 4, 13), 1), 'draftreport'],
        ['finalisereport', 'Finalising Final Report', 'writing', new Date(2022, 4, 22), new Date(2022, 5, 16), , percent(new Date(2022, 4, 30), 25), 'p4'],
        ['submitfinal', 'Submit Final Thesis', 'deadline', new Date(2022, 5, 17), new Date(2022, 5, 18), , percent(new Date(2022, 5, 17), 1), 'finalisereport'],
        ['makepres', 'Preparing Final Presentation', '', new Date(2022, 5, 20), new Date(2022, 5, 23), , percent(new Date(2022, 5, 20), 4), 'p4'],
      ]);

      var options = {
        height: 1000,
        width: 1400,
        gantt: {
          defaultStartDate: new Date(2021, 8, 1),
          criticalPathEnabled: true,
          // criticalPathStyle: {
          //   stroke: '#890e08',
          //   strokeWidth: 6
          // }
          innerGridHorizLine: {
            stroke: '#acb4b7',
            strokeWidth: 1
          },
          innerGridTrack: {fill: '#fff'},
          innerGridDarkTrack: {fill: '#dce9ef'},
          barCornerRadius: 1,
          barHeight: 22,
          shadowOffset: 2,
          sortTasks: true,
          arrow: {
            angle: 50,
            width: 2,
            color: '#890842',
            radius: 5
          }
        }
      };


      var chart = new google.visualization.Gantt(document.getElementById('chart_div'));

      chart.draw(otherData, options);
    }
  </script>
</head>
<body>
  <div id="chart_div"></div>
</body>
</html>
